<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forum API Documentation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3, h4 {
            color: #0066cc;
            margin-top: 30px;
        }
        h1 {
            border-bottom: 2px solid #0066cc;
            padding-bottom: 10px;
        }
        pre {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        code {
            font-family: 'Courier New', Courier, monospace;
            background-color: #f5f5f5;
            padding: 2px 4px;
            border-radius: 3px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .endpoint {
            margin-bottom: 30px;
            border-left: 4px solid #0066cc;
            padding-left: 15px;
        }
        .method {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            margin-right: 10px;
        }
        .get { background-color: #61affe; }
        .post { background-color: #49cc90; }
        .put { background-color: #fca130; }
        .delete { background-color: #f93e3e; }
        .container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        .content {
            flex: 1;
        }
        .footer {
            margin-top: 40px;
            border-top: 1px solid #eee;
            padding-top: 20px;
            text-align: center;
            font-size: 14px;
            color: #777;
        }
        a {
            color: #0066cc;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .nav {
            margin: 20px 0;
            padding: 0;
        }
        .nav li {
            display: inline-block;
            margin-right: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="content">
            <h1>Forum API Documentation</h1>
            
            <ul class="nav">
                <li><a href="#overview">Overview</a></li>
                <li><a href="#endpoints">API Endpoints</a></li>
                <li><a href="#models">Data Models</a></li>
                <li><a href="#monitoring">Monitoring</a></li>
                <li><a href="#testing">Load Testing</a></li>
            </ul>
            
            <section id="overview">
                <h2>Overview</h2>
                <p>The Forum API provides endpoints for creating and managing discussion boards, posts, and comments. It's built with Rust using the Actix-Web framework and uses ScyllaDB as the database backend.</p>
                
                <h3>Base URL</h3>
                <p>All URLs referenced in the documentation have the following base:</p>
                <pre><code>http://localhost:8080</code></pre>
                
                <h3>Authentication</h3>
                <p>This API does not currently implement authentication.</p>
                
                <h3>Interactive API Documentation</h3>
                <p>For interactive API documentation, please visit <a href="/docs">/docs</a> which provides a Swagger UI for testing the API endpoints.</p>
            </section>
            
            <section id="endpoints">
                <h2>API Endpoints</h2>
                
                <h3>Health and Monitoring</h3>
                
                <div class="endpoint">
                    <span class="method get">GET</span> <code>/health</code>
                    <p>Check the health status of the API</p>
                    <h4>Response</h4>
                    <pre><code>{
    "status": "OK",
    "version": "0.1.0",
    "timestamp": "2023-08-20T14:30:00Z"
}</code></pre>
                </div>
                
                <div class="endpoint">
                    <span class="method get">GET</span> <code>/metrics</code>
                    <p>Get Prometheus metrics for the API</p>
                    <p>Returns metrics in Prometheus text format.</p>
                </div>
                
                <h3>Boards</h3>
                
                <div class="endpoint">
                    <span class="method get">GET</span> <code>/boards</code>
                    <p>Get a list of all discussion boards</p>
                    <h4>Response</h4>
                    <pre><code>[
    {
        "id": "123e4567-e89b-12d3-a456-426614174000",
        "name": "General Discussion",
        "description": "A place to discuss anything",
        "created_at": "2023-08-20T14:30:00Z"
    },
    ...
]</code></pre>
                </div>
                
                <div class="endpoint">
                    <span class="method post">POST</span> <code>/boards</code>
                    <p>Create a new discussion board</p>
                    <h4>Request Body</h4>
                    <pre><code>{
    "name": "General Discussion",
    "description": "A place to discuss anything"
}</code></pre>
                    <h4>Response</h4>
                    <pre><code>{
    "id": "123e4567-e89b-12d3-a456-426614174000",
    "name": "General Discussion",
    "description": "A place to discuss anything",
    "created_at": "2023-08-20T14:30:00Z"
}</code></pre>
                </div>
                
                <div class="endpoint">
                    <span class="method get">GET</span> <code>/boards/{board_id}</code>
                    <p>Get details for a specific board</p>
                    <h4>Path Parameters</h4>
                    <table>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>board_id</td>
                            <td>UUID</td>
                            <td>The ID of the board to retrieve</td>
                        </tr>
                    </table>
                    <h4>Response</h4>
                    <pre><code>{
    "id": "123e4567-e89b-12d3-a456-426614174000",
    "name": "General Discussion",
    "description": "A place to discuss anything",
    "created_at": "2023-08-20T14:30:00Z"
}</code></pre>
                </div>
                
                <h3>Posts</h3>
                
                <div class="endpoint">
                    <span class="method post">POST</span> <code>/posts</code>
                    <p>Create a new post on a board</p>
                    <h4>Request Body</h4>
                    <pre><code>{
    "board_id": "123e4567-e89b-12d3-a456-426614174000",
    "title": "Hello World",
    "content": "This is my first post!",
    "author": "User123"
}</code></pre>
                    <h4>Response</h4>
                    <pre><code>{
    "id": "123e4567-e89b-12d3-a456-426614174001",
    "board_id": "123e4567-e89b-12d3-a456-426614174000",
    "title": "Hello World",
    "content": "This is my first post!",
    "created_at": "2023-08-20T14:35:00Z",
    "author": "User123"
}</code></pre>
                </div>
                
                <div class="endpoint">
                    <span class="method get">GET</span> <code>/posts/{post_id}</code>
                    <p>Get details for a specific post</p>
                    <h4>Path Parameters</h4>
                    <table>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>post_id</td>
                            <td>UUID</td>
                            <td>The ID of the post to retrieve</td>
                        </tr>
                    </table>
                    <h4>Response</h4>
                    <pre><code>{
    "id": "123e4567-e89b-12d3-a456-426614174001",
    "board_id": "123e4567-e89b-12d3-a456-426614174000",
    "title": "Hello World",
    "content": "This is my first post!",
    "created_at": "2023-08-20T14:35:00Z",
    "author": "User123"
}</code></pre>
                </div>
                
                <div class="endpoint">
                    <span class="method get">GET</span> <code>/boards/{board_id}/posts</code>
                    <p>Get all posts for a specific board</p>
                    <h4>Path Parameters</h4>
                    <table>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>board_id</td>
                            <td>UUID</td>
                            <td>The ID of the board to get posts from</td>
                        </tr>
                    </table>
                    <h4>Response</h4>
                    <pre><code>[
    {
        "id": "123e4567-e89b-12d3-a456-426614174001",
        "board_id": "123e4567-e89b-12d3-a456-426614174000",
        "title": "Hello World",
        "content": "This is my first post!",
        "created_at": "2023-08-20T14:35:00Z",
        "author": "User123"
    },
    ...
]</code></pre>
                </div>
                
                <h3>Comments</h3>
                
                <div class="endpoint">
                    <span class="method post">POST</span> <code>/comments</code>
                    <p>Create a new comment on a post</p>
                    <h4>Request Body</h4>
                    <pre><code>{
    "post_id": "123e4567-e89b-12d3-a456-426614174001",
    "content": "Great post!",
    "author": "User456"
}</code></pre>
                    <h4>Response</h4>
                    <pre><code>{
    "id": "123e4567-e89b-12d3-a456-426614174002",
    "post_id": "123e4567-e89b-12d3-a456-426614174001",
    "content": "Great post!",
    "created_at": "2023-08-20T14:40:00Z",
    "author": "User456"
}</code></pre>
                </div>
                
                <div class="endpoint">
                    <span class="method get">GET</span> <code>/posts/{post_id}/comments</code>
                    <p>Get all comments for a specific post</p>
                    <h4>Path Parameters</h4>
                    <table>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>post_id</td>
                            <td>UUID</td>
                            <td>The ID of the post to get comments from</td>
                        </tr>
                    </table>
                    <h4>Response</h4>
                    <pre><code>[
    {
        "id": "123e4567-e89b-12d3-a456-426614174002",
        "post_id": "123e4567-e89b-12d3-a456-426614174001",
        "content": "Great post!",
        "created_at": "2023-08-20T14:40:00Z",
        "author": "User456"
    },
    ...
]</code></pre>
                </div>
                
                <h3>Testing</h3>
                
                <div class="endpoint">
                    <span class="method get">GET</span> <code>/slow</code>
                    <p>Intentionally slow endpoint for testing alerts</p>
                    <p>This endpoint is artificially delayed to trigger latency alerts for monitoring tests.</p>
                </div>
            </section>
            
            <section id="models">
                <h2>Data Models</h2>
                
                <h3>Board</h3>
                <table>
                    <tr>
                        <th>Field</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>id</td>
                        <td>UUID</td>
                        <td>Unique identifier for the board</td>
                    </tr>
                    <tr>
                        <td>name</td>
                        <td>String</td>
                        <td>Name of the board</td>
                    </tr>
                    <tr>
                        <td>description</td>
                        <td>String</td>
                        <td>Description of the board</td>
                    </tr>
                    <tr>
                        <td>created_at</td>
                        <td>DateTime</td>
                        <td>When the board was created</td>
                    </tr>
                </table>
                
                <h3>Post</h3>
                <table>
                    <tr>
                        <th>Field</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>id</td>
                        <td>UUID</td>
                        <td>Unique identifier for the post</td>
                    </tr>
                    <tr>
                        <td>board_id</td>
                        <td>UUID</td>
                        <td>ID of the board this post belongs to</td>
                    </tr>
                    <tr>
                        <td>title</td>
                        <td>String</td>
                        <td>Title of the post</td>
                    </tr>
                    <tr>
                        <td>content</td>
                        <td>String</td>
                        <td>Content of the post</td>
                    </tr>
                    <tr>
                        <td>created_at</td>
                        <td>DateTime</td>
                        <td>When the post was created</td>
                    </tr>
                    <tr>
                        <td>author</td>
                        <td>String</td>
                        <td>Author of the post</td>
                    </tr>
                </table>
                
                <h3>Comment</h3>
                <table>
                    <tr>
                        <th>Field</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>id</td>
                        <td>UUID</td>
                        <td>Unique identifier for the comment</td>
                    </tr>
                    <tr>
                        <td>post_id</td>
                        <td>UUID</td>
                        <td>ID of the post this comment belongs to</td>
                    </tr>
                    <tr>
                        <td>content</td>
                        <td>String</td>
                        <td>Content of the comment</td>
                    </tr>
                    <tr>
                        <td>created_at</td>
                        <td>DateTime</td>
                        <td>When the comment was created</td>
                    </tr>
                    <tr>
                        <td>author</td>
                        <td>String</td>
                        <td>Author of the comment</td>
                    </tr>
                </table>
            </section>
            
            <section id="monitoring">
                <h2>Monitoring</h2>
                <p>This API is integrated with comprehensive monitoring tools:</p>
                
                <h3>Metrics</h3>
                <p>Metrics are available through Prometheus at <a href="http://localhost:9090">http://localhost:9090</a></p>
                <p>Key metrics:</p>
                <ul>
                    <li><code>api_requests_total</code>: Total number of API requests</li>
                    <li><code>db_requests_total</code>: Total number of database requests</li>
                </ul>
                
                <h3>Grafana Dashboards</h3>
                <p>Visualization dashboards are available at <a href="http://localhost:3000">http://localhost:3000</a> (login with admin/admin)</p>
                
                <h3>Distributed Tracing</h3>
                <p>Request tracing is available through Jaeger at <a href="http://localhost:16686">http://localhost:16686</a></p>
                <p>Each request is assigned a <code>X-Trace-ID</code> header that can be used to trace the request through the system.</p>
                
                <h3>Alerting</h3>
                <p>Alerts are configured to trigger when:</p>
                <ul>
                    <li>P99 latency exceeds 500ms for more than 1 minute</li>
                    <li>Database request rate exceeds 100 RPS for more than 1 minute</li>
                </ul>
                <p>Alerts are sent to a configured Telegram channel.</p>
            </section>
            
            <section id="testing">
                <h2>Load Testing</h2>
                <p>A load testing UI is available at <a href="http://localhost:8089">http://localhost:8089</a></p>
                <p>This interface allows you to simulate various load patterns on the API to test performance under different conditions.</p>
                
                <h3>Running a Load Test</h3>
                <ol>
                    <li>Open the Locust UI at <a href="http://localhost:8089">http://localhost:8089</a></li>
                    <li>Set the number of users and spawn rate</li>
                    <li>Click "Start swarming" to begin the test</li>
                    <li>Monitor the real-time statistics and charts</li>
                </ol>
                
                <h3>Triggering Alerts</h3>
                <p>To trigger the high latency alert, run a load test with at least 50 users that includes the <code>/slow</code> endpoint.</p>
                <p>To trigger the high DB RPS alert, run a load test with at least 200 users focused on write operations.</p>
            </section>
        </div>
        
        <footer class="footer">
            <p>Forum API Documentation - Version 1.0.0</p>
        </footer>
    </div>
</body>
</html> 